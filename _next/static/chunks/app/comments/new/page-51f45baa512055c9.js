(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[396],{148:(e,t,r)=>{Promise.resolve().then(r.bind(r,605))},605:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(5155),a=r(2115),l=r(1322),o=r(3699),n=r(3568);function i(e){let{comment:t,onSuccess:r,onError:i}=e,[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)({}),[b,f]=(0,a.useState)({});(0,a.useEffect)(()=>{m(t||{text:"",author:"",relatedRecord:""}),f({})},[t]);let x=()=>{var e;let t={};return(null==(e=u.text)?void 0:e.trim())||(t.text="Comment text is required"),f(t),0===Object.keys(t).length},y=e=>{let{id:t,value:r}=e.target;m(e=>({...e,[t]:r})),b[t]&&f(e=>({...e,[t]:void 0}))},h=async e=>{if(e.preventDefault(),!x())return void n.Ay.error("Please fix the errors in the form.");d(!0);let s=n.Ay.loading(t?"Updating comment...":"Creating comment...");try{let e,a=t?"Comment updated successfully!":"Comment created successfully!",c=t?"Failed to update comment":"Failed to create comment";if((e=t?await (0,l.vL)(o.CG.COMMENTS,t.id,u):await (0,l.eC)(o.CG.COMMENTS,u)).success)n.Ay.success(a,{id:s}),r();else{let t=e.error||c;n.Ay.error(t,{id:s}),i(t)}}catch(t){let e=t instanceof Error?t.message:"An unexpected error occurred";n.Ay.error(e,{id:s}),i(e)}finally{d(!1)}},g=async()=>{if(!t||!confirm("Are you sure you want to delete this comment?"))return;d(!0);let e=n.Ay.loading("Deleting comment...");try{let s=await (0,l.LK)(o.CG.COMMENTS,t.id);if(s.success)n.Ay.success("Comment deleted successfully!",{id:e}),r();else{let t=s.error||"Failed to delete comment";n.Ay.error(t,{id:e}),i(t)}}catch(r){let t=r instanceof Error?r.message:"An unexpected error occurred";n.Ay.error(t,{id:e}),i(t)}finally{d(!1)}};return(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"text",className:"block text-sm font-medium text-gray-700",children:["Comment ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("textarea",{id:"text",value:u.text||"",onChange:y,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 ".concat(b.text?"border-red-500":""),rows:3,"aria-describedby":b.text?"text-error":void 0}),b.text&&(0,s.jsx)("p",{id:"text-error",className:"mt-1 text-sm text-red-600",children:b.text})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"author",className:"block text-sm font-medium text-gray-700",children:"Author"}),(0,s.jsx)("input",{type:"text",id:"author",value:u.author||"",onChange:y,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"relatedRecord",className:"block text-sm font-medium text-gray-700",children:"Related Record"}),(0,s.jsx)("input",{type:"text",id:"relatedRecord",value:u.relatedRecord||"",onChange:y,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50",children:c?"Saving...":t?"Update Comment":"Create Comment"}),t&&(0,s.jsx)("button",{type:"button",onClick:g,disabled:c,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:c?"Deleting...":"Delete Comment"})]})]})})}var c=r(5695);function d(){let e=(0,c.useRouter)();return(0,s.jsxs)("div",{className:"container mx-auto py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Add Comment"}),(0,s.jsx)(i,{onSuccess:()=>{e.push("/comments")},onError:e=>{}})]})}},1322:(e,t,r)=>{"use strict";r.d(t,{DQ:()=>o,LK:()=>c,eC:()=>n,vL:()=>i});var s=r(8956),a=r.n(s);function l(){let e="patB6rwNADWNQswxy.9d5acbffc33a62c896d920b77b1c75bab5dd6aabb7e669980ec85135eee70448",t="app7G3Ae65pBblJke";if(!e||!t)throw Error("Airtable API Key or Base ID is missing from environment variables.");return new(a())({apiKey:e}).base(t)}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l()(e),{filterBy:s,filterValue:a,filterByFormula:o,sortBy:n,sortDirection:i="asc",pageSize:c=100,fields:d}=t,u={pageSize:c};o?u.filterByFormula=o:s&&a&&("RECORD_ID()"===s.toUpperCase()?u.filterByFormula="RECORD_ID() = '".concat(a,"'"):u.filterByFormula="{".concat(s,"} = '").concat(a,"'")),n&&(u.sort=[{field:n,direction:i}]),d&&d.length>0&&(u.fields=d);try{let e=(await r.select(u).all()).map(e=>{var t;return{id:e.id,createdTime:null==(t=e._rawJson)?void 0:t.createdTime,...e.fields}});return{records:e,totalCount:e.length}}catch(e){return{records:[],totalCount:0}}}async function n(e,t){let r=l();try{var s;let a=(await r(e).create([{fields:t}]))[0];return{success:!0,data:{id:a.id,createdTime:null==(s=a._rawJson)?void 0:s.createdTime,...a.fields}}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async function i(e,t,r){let s=l();try{var a;let l=(await s(e).update([{id:t,fields:r}]))[0];return{success:!0,data:{id:l.id,createdTime:null==(a=l._rawJson)?void 0:a.createdTime,...l.fields}}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async function c(e,t){let r=l();try{return await r(e).destroy([t]),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}},3699:(e,t,r)=>{"use strict";r.d(t,{CG:()=>s}),r(8956),r(9509);let s={STORYTELLERS:"tbl9zxLsGOd3fjWXp",MEDIA:"tbldCVl8n3JyPvamD",THEMES:"tblbfySNA6wg9lR12",QUOTES:"tblCq6v5eQl3GNkBO",GALLERIES:"tbl6YnHXjnPMC6ENx",STORIES:"tbl34r8BqNDgPI3ZN",SHIFTS:"tblArZd2LG32otN1A",MANUAL_TAGS:"tblSKRtr1wAYilVMJ",COMMENTS:"tblMtUK5zvDYL5drk",CONTACT:"tblCAr2KCgtFi0y1M",USERS:"tblMMHSiT7awfSjOR",ASSIGNMENT_TABLE:"tblZB2qXlhGhu8jSI",POST_SHIFT_REFLECTION:"tblu1gdJgiUtc8ZZN",PHOTOGRAPHER_THEMES:"tblAZnGkFw5EtXIq7",FORMS:"tblRwVbSL4vOsJkrw",EMPATHY_JOURNAL:"tblTyQF7nVTX14GpE"}}},e=>{var t=t=>e(e.s=t);e.O(0,[846,568,441,684,358],()=>t(148)),_N_E=e.O()}]);